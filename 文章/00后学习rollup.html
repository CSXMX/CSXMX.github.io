

<!DOCTYPE html>
<html lang="en" color-mode=light>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title> - Hexo</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="google" content="notranslate" />
  
  
  <meta name="author" content="小萌新">
  <link rel="icon" href="/images/icons/favicon-16x16.png" type="image/png" sizes="16x16">
  <link rel="icon" href="/images/icons/favicon-32x32.png" type="image/png" sizes="32x32">
  <link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png" sizes="180x180">
  <meta rel="mask-icon" href="/images/icons/stun-logo.svg" color="#333333">
  
    <meta rel="msapplication-TileImage" content="/images/icons/favicon-144x144.png">
    <meta rel="msapplication-TileColor" content="#000000">
  

  
<link rel="stylesheet" href="/css/style.css">


  
    
<link rel="stylesheet" href="https://at.alicdn.com/t/font_1445822_p6ry5n7lrr.css">

  

  
    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css">

  

  
    
      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/xcode.min.css" name="highlight-style" mode="light">

      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/solarized-dark.min.css" name="highlight-style" mode="dark">

      
  

  <script>
    var CONFIG = window.CONFIG || {};
    var ZHAOO = window.ZHAOO || {};
    CONFIG = {
      isHome: false,
      fancybox: true,
      pjax: false,
      loading: {
        gif: '/images/theme/loading.gif',
        lottie: ''
      },
      lazyload: {
        enable: true,
        only_post: 'false',
        loading: {
          gif: '/images/theme/loading.gif',
          lottie: ''
        }
      },
      donate: {
        enable: true,
        alipay: 'https://pic.izhaoo.com/alipay.jpg',
        wechat: 'https://pic.izhaoo.com/wechat.jpg'
      },
      galleries: {
        enable: true
      },
      fab: {
        enable: true,
        always_show: false
      },
      carrier: {
        enable: true
      },
      daovoice: {
        enable: false
      },
      preview: {
        background: {
          default: '',
          api: ''
        },
        motto: {
          default: '我在开了灯的床头下，想问问自己的心啊。',
          typing: true,
          api: 'https://v2.jinrishici.com/one.json',
          data_contents: '["data","content"]'
        },
      },
      qrcode: {
        enable: true,
        type: 'url',
        image: 'https://pic.izhaoo.com/weapp-code.jpg',
      },
      toc: {
        enable: true
      },
      scrollbar: {
        type: 'default'
      },
      notification: {
        enable: false,
        delay: 4500,
        list: '',
        page_white_list: '',
        page_black_list: ''
      },
      search: {
        enable: false,
        path: ''
      }
    }
  </script>

  

  

<meta name="generator" content="Hexo 6.1.0"></head>

<body class="lock-screen">
  <div class="loading" id="loading"></div>
  
    


  
  

<nav class="menu">
  <div class="menu-container">
    <div class="menu-close">
      <i class="iconfont iconbaseline-close-px"></i>
    </div>
    <ul class="menu-content"><li class="menu-item">
        <a href="/ " class="underline "> 首页</a>
      </li></ul>
    
      <div class="menu-copyright"><p>Powered by <a target="_blank" href="https://hexo.io">Hexo</a>  |  作者 - <a target="_blank" href="https://github.com/izhaoo/hexo-theme-zhaoo">小萌新</a></p></div>
    
  </div>
</nav>
  <main id="main">
  <div class="article-wrap">
    <div class="row container">
      <div class="col-xl-3"></div>
      <div class="col-xl-6"><article class="article">
  <div class="wrap">
    <section class="head">
  <img   class="lazyload" data-original="/images/theme/post-image.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  draggable="false">
  <div class="head-mask">
    <h1 class="head-title"></h1>
    <div class="head-info">
      <span class="post-info-item"><i class="iconfont iconcalendar"></i>February 13, 2023</span>
      
      <span class="post-info-item"><i class="iconfont iconfont-size"></i>6840</span>
    </div>
  </div>
</section>
    <section class="main">
      <section class="content">
        
        <h1 id="00后学习rollup-plugin"><a href="#00后学习rollup-plugin" class="headerlink" title="00后学习rollup plugin"></a>00后学习rollup plugin</h1><h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h2><p>rollup文档链接：<a target="_blank" rel="noopener" href="https://www.rollupjs.com/guide/plugin-development">https://www.rollupjs.com/guide/plugin-development</a></p>
<p>学习第一步，阅读文档。</p>
<p>正如官方文档所说的，rollup plugin本质就是一个 包含 属性（properties）, 构建钩子（build hook），</p>
<p>输出生成钩子（output generation hooks） 的对象（object）。</p>
<h2 id="2-举例"><a href="#2-举例" class="headerlink" title="2. 举例"></a>2. 举例</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// rollup-plugin-my-example.js</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">myExample</span> () &#123;<br>  <span class="hljs-keyword">return</span> &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;my-example&#x27;</span>, <span class="hljs-comment">// this name will show up in warnings and errors</span><br>    resolveId ( source ) &#123;<br>      <span class="hljs-keyword">if</span> (source === <span class="hljs-string">&#x27;virtual-module&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> source; <span class="hljs-comment">// this signals that rollup should not ask other plugins or check the file system to find this id</span><br>      &#125;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// other ids should be handled as usually</span><br>    &#125;,<br>    load ( id ) &#123;<br>      <span class="hljs-keyword">if</span> (id === <span class="hljs-string">&#x27;virtual-module&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;export default &quot;This is virtual!&quot;&#x27;</span>; <span class="hljs-comment">// the source code for &quot;virtual-module&quot;</span><br>      &#125;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// other ids should be handled as usually</span><br>    &#125;<br>  &#125;;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h2 id="3-起因"><a href="#3-起因" class="headerlink" title="3. 起因"></a>3. 起因</h2><p>与众多的构建工具一样，在一个真实的项目场景中，rollup本身提供的能力未必能满足复杂的构建需求。</p>
<p>如果把处理逻辑跟打包的逻辑混在一起，就会导致与rollup配置相关的核心代码显得特别臃肿，也不利于维护。</p>
<p>所以，Rollup 设计出了一套完整的插件机制，可根据不同的构建需求引入对应的插件。</p>
<h2 id="4-方向"><a href="#4-方向" class="headerlink" title="4. 方向"></a>4. 方向</h2><p>在Rollup 的打包过程中，会定义一套完整的构建生命周期，从开始打包到产物输出，中间会经历多个阶段，</p>
<p>同时在不同的阶段会执行对应的插件钩子函数(Hook)。</p>
<p>所以，记忆并理解rollup的插件钩子函数是学习rollup plugin的重要方向。</p>
<h2 id="5-整体"><a href="#5-整体" class="headerlink" title="5. 整体"></a>5. 整体</h2><p>从整体的角度来说，rollup一次完整的构建周期可分为两大阶段，build（构建）和output（输出）阶段。</p>
<p><strong>build阶段：</strong>解析各模块的内容，根据模块间的依赖关系构建依赖图。</p>
<p><strong>output阶段：</strong>代码的打包与输出</p>
<h2 id="6-分类"><a href="#6-分类" class="headerlink" title="6. 分类"></a>6. 分类</h2><p>对于rollup插件钩子的类型，我们可以进行一个分类。</p>
<p>（1）<strong>分类标准</strong>：钩子执行时所处的阶段</p>
<p><strong>build hook</strong></p>
<p> 主要事情：模块代码 -&gt; 抽象语法树（AST），AST -&gt; 目标代码，模块依赖图的构建与解析</p>
<p> 操作粒度：单个模块，单个文件</p>
<p><strong>output hook</strong></p>
<p>主要事情：多个代码的打包</p>
<p>操作粒度： chunk级别，多个模块组成</p>
<p>（2）<strong>分类标准</strong>：钩子执行的方式，官方分类，可叠加</p>
<p><strong>async：</strong>异步的钩子 （return a promise resolving to the same type of value）</p>
<p><strong>sync：</strong>同步的钩子</p>
<p><strong>first：</strong>如果有多个插件实现了这个 Hook，那么 Hook 将依次运行，直到返回一个非 null 或非 undefined 的值为止。</p>
<p><strong>sequential：</strong>串行的钩子函数，如果有几个插件实现了这个钩子，它们都会按照指定的插件顺序运行。如果一个钩子是异步的，则此类后续钩子将等待当前挂钩被解析。这种 Hook 往往适用于插件间处理结果相互依赖的情况，即前一个插件 Hook 的返回值作为后续插件的入参。</p>
<p><strong>parallel：</strong>并行的钩子函数, 各走各的，互不干扰。</p>
<h2 id="7-解读"><a href="#7-解读" class="headerlink" title="7. 解读"></a>7. 解读</h2><p>下面我将从rollup的钩子函数中提取一部分，简单介绍下 rollup 的完整工作流程。</p>
<p>（1）options：串行钩子，解析配置文件，得到新的配置对象。</p>
<p>（2）buildStart:  并行钩子，开始构建流程。</p>
<p>（3）resolveId：first钩子，从入口文件开始解析文件的路径，只有一个插件的resolveId返回了路径，其余插件的resolveId也就会停止执行。</p>
<p>（4）load：first钩子，加载模块内容。</p>
<p>（5）transform：串行钩子，根据模块依赖图确定指定顺序，执行所有的transform钩子，对于模块内容进行转换，例如把es6转换成es5。</p>
<p>（6）在解析模块路径时，如果是external（排除）属性，则跳过打包过程。</p>
<p>（7）resolveDynamicImport：first钩子，如果遇到动态import请求，解析路径成功后会跳到load钩子，加载模块内容。解析路径失败或者是普通的import请求，则会跳转resolveId继续解析路径。</p>
<p>（8）buildEnd：并行钩子，构建阶段结束。</p>
<p>（9）outputOptions：串行钩子，读取output配置。</p>
<p>（10）renderStart：并行钩子，开始打包。</p>
<p>（11）banner、footer、intro、outro钩子：并行钩子，在打包产物的固定位置(比如头部和尾部)插入一些自定义的内容，比如协议声明内容、项目介绍等等。</p>
<p>（12）renderChunk：串行钩子，可获取到chunk 代码内容和chunk 元信息。</p>
<p>（13）generateBundle：串行钩子，产物生成前的最后一步。可获取到output配置和打包产物的元信息，通过操作元信息可以删除一些无用的chunk，也可以输出自定义的新资源。</p>
<p>（14）writeBundle：并行钩子，产物已生成。</p>
<p>（15）closeBundle:  并行钩子，打包结束。</p>
<h2 id="8-实战"><a href="#8-实战" class="headerlink" title="8. 实战"></a>8. 实战</h2><p>下面 是 rollup插件 @rollup&#x2F;plugin-alias的源码，功能：设置路径的别名。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 判断路径是否匹配</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">matches</span>(<span class="hljs-params">pattern, importee</span>) &#123;<br>    <span class="hljs-keyword">if</span> (pattern <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">RegExp</span>) &#123;<br>        <span class="hljs-keyword">return</span> pattern.<span class="hljs-title function_">test</span>(importee);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (importee.<span class="hljs-property">length</span> &lt; pattern.<span class="hljs-property">length</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (importee === pattern) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-comment">// eslint-disable-next-line prefer-template</span><br>    <span class="hljs-keyword">return</span> importee.<span class="hljs-title function_">startsWith</span>(pattern + <span class="hljs-string">&#x27;/&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getEntries</span>(<span class="hljs-params">&#123;</span><br><span class="hljs-params">    entries, </span><br><span class="hljs-params">    customResolver // 自定义路径解析方法</span><br><span class="hljs-params">&#125;</span>) &#123;<br>    <span class="hljs-keyword">if</span> (!entries) &#123;<br>        <span class="hljs-keyword">return</span> [];<br>    &#125;<br>    <span class="hljs-keyword">const</span> resolverFunctionFromOptions = <span class="hljs-title function_">resolveCustomResolver</span>(customResolver);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(entries)) &#123;<br>        <span class="hljs-keyword">return</span> entries.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> &#123;<br>                <span class="hljs-attr">find</span>: entry.<span class="hljs-property">find</span>,<br>                <span class="hljs-attr">replacement</span>: entry.<span class="hljs-property">replacement</span>,<br>                <span class="hljs-attr">resolverFunction</span>: <span class="hljs-title function_">resolveCustomResolver</span>(entry.<span class="hljs-property">customResolver</span>) || resolverFunctionFromOptions<br>            &#125;;<br>        &#125;);<br>    &#125;<br>  	<span class="hljs-comment">// 解析成一个对象，例如路径中’@‘-&gt;&#x27;./src&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(entries).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">find</span>: key,<br>            <span class="hljs-attr">replacement</span>: value,<br>            <span class="hljs-attr">resolverFunction</span>: resolverFunctionFromOptions<br>        &#125;;<br>    &#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getHookFunction</span>(<span class="hljs-params">hook</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> hook === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> hook;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (hook &amp;&amp; <span class="hljs-string">&#x27;handler&#x27;</span> <span class="hljs-keyword">in</span> hook &amp;&amp; <span class="hljs-keyword">typeof</span> hook.<span class="hljs-property">handler</span> === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> hook.<span class="hljs-property">handler</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">resolveCustomResolver</span>(<span class="hljs-params">customResolver</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> customResolver === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> customResolver;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (customResolver) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">getHookFunction</span>(customResolver.<span class="hljs-property">resolveId</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">alias</span>(<span class="hljs-params">options = &#123;&#125;</span>) &#123;<br>    <span class="hljs-keyword">const</span> entries = <span class="hljs-title function_">getEntries</span>(options);<br>    <span class="hljs-keyword">if</span> (entries.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;alias&#x27;</span>,<br>            <span class="hljs-attr">resolveId</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-literal">null</span><br>        &#125;;<br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;alias&#x27;</span>,<br>        <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildStart</span>(<span class="hljs-params">inputOptions</span>) &#123;<br>            <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([...(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(options.<span class="hljs-property">entries</span>) ? options.<span class="hljs-property">entries</span> : []), options].<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">&#123;</span></span><br><span class="hljs-params"><span class="hljs-function">                customResolver</span></span><br><span class="hljs-params"><span class="hljs-function">            &#125;</span>) =&gt;</span> &#123;<br>                <span class="hljs-keyword">var</span> _a;<br>                <span class="hljs-keyword">return</span> customResolver &amp;&amp; ((_a = <span class="hljs-title function_">getHookFunction</span>(customResolver.<span class="hljs-property">buildStart</span>)) === <span class="hljs-literal">null</span> || _a === <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> ? <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> : _a.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, inputOptions));<br>            &#125;));<br>        &#125;,<br>        <span class="hljs-title function_">resolveId</span>(<span class="hljs-params">importee, importer, resolveOptions</span>) &#123;<br>          <span class="hljs-comment">/*</span><br><span class="hljs-comment">importee，当前资源路径（import ‘xx’语句中的xx原始字符串）</span><br><span class="hljs-comment">importer，被哪个模块导入的，父模块的路径（一般是绝对路径，如果importee是入口文件，则该值为undefined。表示没有父模块导入它）。</span><br><span class="hljs-comment">resolveOptions，可能用到的一些配置。比如isEntry: boolean，当前impotee文件是不是入口文件之类的。</span><br><span class="hljs-comment">*/</span><br>            <span class="hljs-keyword">if</span> (!importer) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>            &#125;<br>            <span class="hljs-comment">// First match is supposed to be the correct one</span><br>            <span class="hljs-keyword">const</span> matchedEntry = entries.<span class="hljs-title function_">find</span>(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> <span class="hljs-title function_">matches</span>(entry.<span class="hljs-property">find</span>, importee));<br>            <span class="hljs-keyword">if</span> (!matchedEntry) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>            &#125;<br>          	<span class="hljs-comment">//匹配成功，路径替换</span><br>            <span class="hljs-keyword">const</span> updatedId = importee.<span class="hljs-title function_">replace</span>(matchedEntry.<span class="hljs-property">find</span>, matchedEntry.<span class="hljs-property">replacement</span>);<br>       		<span class="hljs-comment">// resolverFunction对应选项中的customResolver，自定义的路径解析算法</span><br>            <span class="hljs-keyword">if</span> (matchedEntry.<span class="hljs-property">resolverFunction</span>) &#123;<br>                <span class="hljs-keyword">return</span> matchedEntry.<span class="hljs-property">resolverFunction</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, updatedId, importer, resolveOptions);<br>            &#125;<br>          	<span class="hljs-comment">// this.resolve是rollup自带的路径解析算法，返回一个资源对象</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resolve</span>(updatedId, importer, <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(&#123;<br>                <span class="hljs-attr">skipSelf</span>: <span class="hljs-literal">true</span><br>            &#125;, resolveOptions)).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">resolved</span>) =&gt;</span> resolved || &#123;<br>                <span class="hljs-attr">id</span>: updatedId<br>            &#125;);<br>        &#125;<br>    &#125;;<br>&#125;<br><br><span class="hljs-keyword">export</span> &#123;<br>    alias <span class="hljs-keyword">as</span><br>    <span class="hljs-keyword">default</span><br>&#125;;<br><span class="hljs-comment">//# sourceMappingURL=index.js.map</span><br></code></pre></td></tr></table></figure>


      </section>
      <section class="extra">
        
          <ul class="copyright">
  
    <li><strong>本文作者：</strong>小萌新</li>
    <li><strong>本文链接：</strong><a href="http://example.com/%E6%96%87%E7%AB%A0/00%E5%90%8E%E5%AD%A6%E4%B9%A0rollup.html" title="http:&#x2F;&#x2F;example.com&#x2F;%E6%96%87%E7%AB%A0&#x2F;00%E5%90%8E%E5%AD%A6%E4%B9%A0rollup.html">http:&#x2F;&#x2F;example.com&#x2F;%E6%96%87%E7%AB%A0&#x2F;00%E5%90%8E%E5%AD%A6%E4%B9%A0rollup.html</a></li>
    <li><strong>版权声明：</strong>本博客所有文章均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" title="BY-NC-SA" target="_blank" rel="noopener">BY-NC-SA</a> 许可协议，转载请注明出处！</li>
  
</ul>
        
        
          <section class="donate">
  <div id="qrcode-donate">
    <img   class="lazyload" data-original="https://pic.izhaoo.com/alipay.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" >
  </div>
  <div class="icon">
    <a href="javascript:;" id="alipay"><i class="iconfont iconalipay"></i></a>
    <a href="javascript:;" id="wechat"><i class="iconfont iconwechat-fill"></i></a>
  </div>
</section>
        
        
        
      </section>
      
    </section>
  </div>
</article></div>
      <div class="col-xl-3">
        
          
  <aside class="toc-wrap">
    <h3 class="toc-title">文章目录：</h3>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#00%E5%90%8E%E5%AD%A6%E4%B9%A0rollup-plugin"><span class="toc-text">00后学习rollup plugin</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%89%8D%E8%A8%80"><span class="toc-text">1. 前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E4%B8%BE%E4%BE%8B"><span class="toc-text">2. 举例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%B5%B7%E5%9B%A0"><span class="toc-text">3. 起因</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%96%B9%E5%90%91"><span class="toc-text">4. 方向</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%95%B4%E4%BD%93"><span class="toc-text">5. 整体</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%88%86%E7%B1%BB"><span class="toc-text">6. 分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%A7%A3%E8%AF%BB"><span class="toc-text">7. 解读</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%AE%9E%E6%88%98"><span class="toc-text">8. 实战</span></a></li></ol></li></ol>
  </aside>

        
      </div>
    </div>
  </div>
</main>
  

<footer class="footer">
  <div class="footer-social"><a 
        href="tencent://message/?Menu=yes&uin=894519210 "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#12B7F5'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconQQ "></i>
      </a><a 
        href="javascript:; "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#09BB07'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconwechat-fill "></i>
      </a><a 
        href="https://www.instagram.com/izhaoo/ "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#DA2E76'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconinstagram "></i>
      </a><a 
        href="https://github.com/zhaoo "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#9f7be1'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  icongithub-fill "></i>
      </a><a 
        href="mailto:izhaoo@163.com "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color=#FF3B00" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconmail"></i>
      </a></div>
  
    <div class="footer-copyright"><p>Powered by <a target="_blank" href="https://hexo.io">Hexo</a>  |  作者 - <a target="_blank" href="https://github.com/izhaoo/hexo-theme-zhaoo">小萌新</a></p></div>
  
</footer>
  
      <div class="fab fab-plus">
    <i class="iconfont iconplus"></i>
  </div>
  
  
  
  <div class="fab fab-up">
    <i class="iconfont iconcaret-up"></i>
  </div>
  
  
  
    
<script src="/js/color-mode.js"></script>

  
  
</body>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>





  
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>




  
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>






  
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.qrcode/1.0/jquery.qrcode.min.js"></script>




<script src="/js/utils.js"></script>
<script src="/js/script.js"></script>







  <script>
    (function () {
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>













</html>